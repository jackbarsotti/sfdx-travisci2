{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "sfdxProjectSchema.json#",
  "type": "object",
  "title": "SFDX Project",
  "description": "The properties and shape of the SFDX project",
  "properties": {
    "namespace": {
      "type": "string",
      "title": "Namespace",
      "description": "The project's namespace"
    },
    "sfdcLoginUrl": {
      "type": "string",
      "title": "SFDC Login URL",
      "description": "The Salesforce Login URL",
      "default": "https://login.salesforce.com"
    },
    "sourceApiVersion": {
      "type": "string",
      "title": "Source API Version",
      "description": "The API version of the Salesforce DX-formatted source",
      "default": "43.0"
    },
    "softExit": {
      "type": "boolean",
      "title": "Soft Exit",
      "description": "Enable or disable soft exit mode"
    },
    "enableTokenEncryption": {
      "type": "boolean",
      "title": "Enable Token Encryption",
      "description": "Enable or disable token encryption"
    },
    "plugins": {
      "type": "object",
      "title": "CLI Plugins custom settings",
      "description": "Plugins custom settings that users can set for a project.",
      "additionalProperties": true
    },
    "packageAliases": {
        "title": "Aliases for packaging ids",
        "type": "object",
        "description": "Acceptable alias name and alias value pairs",
        "patternProperties": {
          "^[ -~]+$": {
            "type": "string",
            "pattern": "^(0Ho|033|05i|04t)([a-zA-Z0-9]{15}|[a-zA-Z0-9]{12})$"
          }
        }
    },
    "packageDirectories": {
      "type": "array",
      "title": "Package Directories",
      "description": "The list of package source directories",
      "items": {
        "$ref": "#/definitions/packageDirectory"
      }
    }
  },
  "additionalProperties": false,
  "required": [
    "sfdcLoginUrl"
  ],
  "definitions": {
    "features": {
      "type": "oneOf",
      "title": "Features",
      "description": "The list of features names to enable",
      "oneOf": [
        {
          "type": "string",
          "title": "Features",
          "description": "The list of feature names to enable as a string"
        },
        {
          "type": "array",
          "title": "Features",
          "description": "The list of feature names to enable as an array",
          "items": {
            "type": "string",
            "title": "Feature Name",
            "description": "Name of the feature to enable"
          }
        }
      ]
    },
    "orgPreferences": {
      "type": "object",
      "title": "Org Preferences",
      "description": "The list of org preferences",
      "properties": {
        "enabled": {
          "type": "array",
          "title": "Enabled Org Preferences",
          "description": "The list of org preferences to enable",
          "items": {
            "type": "string",
            "title": "Org Preference Name",
            "description": "Name of the org preference to enable"
          }
        },
        "disabled": {
          "type": "array",
          "title": "Disabled Org Preferences",
          "description": "The list of org preferences to disable",
          "items": {
            "type": "string",
            "title": "Org Preference Name",
            "description": "Name of the org preference to disable"
          }
        }
      }
    },
    "dependency": {
      "title": "Dependency",
      "description": "Package OR package & versionNumber OR (Deprecated) Dependency packageId & versionNumber OR (Deprecated) subscriberPackageVersionId",
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "packageId": {
              "type": "string",
              "title": "Package ID",
              "description": "The dependency package2 ID (starts with 0Ho)"
            },
            "versionNumber": {
              "type": "string",
              "title": "Version Number",
              "description": "The dependency version number"
            }
          },
          "required": [
            "packageId",
            "versionNumber"
          ]
        },
        {
          "type": "object",
          "properties": {
            "subscriberPackageVersionId": {
              "type": "string",
              "title": "Subscriber Package Version ID",
              "description": "The dependency subscriber package version ID (starts with 04t)"
            }
          },
          "required": [
            "subscriberPackageVersionId"
          ]
        },
        {
          "type": "object",
          "properties": {
            "package": {
              "type": "string",
              "title": "Subscriber Package Version ID or alias",
              "description": "The dependency subscriber package version ID (starts with 04t) or alias for the ID"
            },
            "versionNumber": {
              "type": "string",
              "title": "Version Number",
              "description": "The dependency version number"
            }
          },
          "required": [
            "package"
          ]
        }
      ]
    },
    "packageDirectory": {
      "type": "object",
      "title": "Directory Type",
      "description": "Package source directory type",
      "properties": {
        "path": {
          "type": "string",
          "title": "Path",
          "description": "The path name of the package directory"
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "ID of the package2 for the source directory (starts with 0Ho)"
        },
        "package": {
          "type": "string",
          "title": "Package Identifier",
          "description": "The identifier (ID or alias) for the package."
        },
        "versionName": {
          "type": "string",
          "title": "Version Name",
          "description": "The package version name."
        },
        "versionDescription": {
          "type": "string",
          "title": "Version Description",
          "description": "The package version description"
        },
        "versionNumber": {
          "type": "string",
          "title": "Version Number",
          "description": "The package version number: Major.Minor.Patch.Build"
        },
        "definitionFile": {
          "type": "string",
          "title": "Definition File",
          "description": "Path to the definition json file that specifies org prefs and features"
        },
        "ancestorId": {
          "type": "string",
          "title": "Ancestor ID",
          "description": "The package2 version ancestor ID (starts with 05i)"
        },
        "ancestorVersion": {
          "type": "string",
          "title": "Ancestor Version",
          "description": "The package2 ancestor version number."
        },
        "releaseNotesUrl": {
          "type": "string",
          "title": "Release Notes Url",
          "description": "The release notes url."
        },
        "postInstallUrl": {
          "type": "string",
          "title": "Post Install Url",
          "description": "The post install url."
        },
        "postInstallScript": {
          "type": "string",
          "title": "Post Install Script",
          "description": "The post install script."
        },
        "uninstallScript": {
          "type": "string",
          "title": "Uninstall Script",
          "description": "The uninstall script."
        },
        "includeProfileUserLicenses": {
          "type": "boolean",
          "title": "Include Profile User Licenses",
          "description": "Whether to include <userLicense> elements in profile metadata "
        },
        "default": {
          "type": "boolean",
          "title": "Default",
          "description": "Enable / disable this package directory as default"
        },
        "features": {
          "$ref": "#/definitions/features"
        },
        "orgPreferences": {
          "$ref": "#/definitions/orgPreferences"
        },
        "dependencies": {
          "type": "array",
          "title": "Dependencies",
          "description": "The list of package dependencies",
          "items": {
            "$ref": "#/definitions/dependency"
          },
          "plugins": {
            "type": "object",
            "title": "CLI Plugins custom settings",
            "description": "Plugins custom settings that users can set for a project.",
            "additionalProperties": true,
            "title": "Org Preferences",
            "description": "The list of org preferences",
            "properties": {
              "enabled": {
                "type": "array",
                "title": "Enabled Org Preferences",
                "description": "The list of org preferences to enable",
                "items": {
                  "type": "string",
                  "title": "Org Preference Name",
                  "description": "Name of the org preference to enable"
                }
              },
              "disabled": {
                "type": "array",
                "title": "Disabled Org Preferences",
                "description": "The list of org preferences to disable",
                "items": {
                  "type": "string",
                  "title": "Org Preference Name",
                  "description": "Name of the org preference to disable"
                }
              }
            }
          },
          "definitionFile": {
            "type": "string",
            "title": "Definition File",
            "description": "Path to the definition json file that specifies org prefs and features"
          },
          "features": {
            "type": "string",
            "title": "Features",
            "description": "The list of feature names to enable"
          },
          "orgPreferences": {
            "type": "object",
            "title": "Org Preferences",
            "description": "The list of org preferences",
            "properties": {
              "enabled": {
                "type": "array",
                "title": "Enabled Org Preferences",
                "description": "The list of org preferences to enable",
                "items": {
                  "type": "string",
                  "title": "Org Preference Name",
                  "description": "Name of the org preference to enable"
                }
              },
              "disabled": {
                "type": "array",
                "title": "Disabled Org Preferences",
                "description": "The list of org preferences to disable",
                "items": {
                  "type": "string",
                  "title": "Org Preference Name",
                  "description": "Name of the org preference to disable"
                }
              }
            }
          },
          "dependencies": {
            "type": "array",
            "title": "Dependencies",
            "description": "The list of package dependencies",
            "items": {
              "title": "Dependency",
              "description": "Dependency packageId & versionNumber or subscriberPackageVersionId",
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "packageId": {
                      "type": "string",
                      "title": "Package ID",
                      "description": "The dependency package2 ID (starts with 0Ho)"
                    },
                    "versionNumber": {
                      "type": "string",
                      "title": "Version Number",
                      "description": "The dependency version number"
                    }
                  },
                  "required": [
                    "packageId",
                    "versionNumber"
                  ]
                },
                {
                  "type": "object",
                  "properties": {
                    "subscriberPackageVersionId": {
                      "type": "string",
                      "title": "Subscriber Package Version ID",
                      "description": "The dependency subscriber package version ID (starts with 04t)"
                    }
                  },
                  "required": [
                    "subscriberPackageVersionId"
                  ]
                }
              ]
            }
          }
        }
      },
      "additionalProperties": false,
      "oneOf": [
        {
          "required": [
            "id",
            "path",
            "versionName",
            "versionNumber"
          ]
        },
        {
          "required": [
            "package",
            "path",
            "versionName",
            "versionNumber"
          ]
        }
      ]
    }
  }
}
